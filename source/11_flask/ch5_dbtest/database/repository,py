import cx_Oracle



cpnn = cx_Oracle.connect('scott","tiger', "210.121.189.12:1521/xe")


def get_emp_list():
    cursor = cpnn.cursor()
    sql = "SELECT * FROM EMP"
    cursor.execute(sql)
    emp_list = cursor.fetchall()    
    cursor.description
    keys = [desc[0] for desc in cursor.description]
    for emp in emp_list:
        print(emp)
    return emp_list
def get_emp(empno):
    cursor = cpnn.cursor()
    sql = "SELECT * FROM EMP WHERE EMPNO = :empno"
    cursor.execute(sql, {'empno':empno})
    emp_list = cursor.fetchall()
    cursor.description
    keys = [desc[0] for desc in cursor.description]
    for emp in emp_list:
        print(emp)                
    return emp_list

if __name__ == "__main__":
    emp_list = get_emp_list()
    print(emp_list)
    emp = get_emp(1)    
    print(emp)



# 실행하는 방법 python -m database.repository